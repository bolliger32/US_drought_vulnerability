## do CoCs change over time? IDs? area? etc.
## given that there seems to be a lot of merging, new areas etc.
## it may be best to overlay the drought data over each unique CoC
## mergers get a new id, so we don't have to deal with 2014 id 1 being different from 2013 id 1
## overlay a year's worth of data on each unique CoC
## ask Yang about this- is it a big pain?


wd="" ## change to your own
setwd(wd)

require(downloader)
if (file.exists("PIT_Counts.xlsx")==F){
  download("https://www.hudexchange.info/resources/documents/2007-2015-PIT-Counts-by-CoC.xlsx",
           "PIT_Counts.xlsx",mode="wb")
}

require(xlsx)
allSheets=vector("list",9)

CoC_IDs=c()
for(i in 1:9){
  allSheets[[i]]=read.xlsx("PIT_Counts.xlsx",i,stringsAsFactors=FALSE)
  CoC_IDs=c(CoC_IDs,allSheets[[i]][1:(nrow(allSheets[[i]])-2),1])
  
}
 
length(unique(CoC_IDs)) ## 418
require(mosaic)
sort(tally(CoC_IDs))

length(which(tally(CoC_IDs)<9)) ## 24 were not the same, either added on own or an amalgam

names(byCoC2015)
byCoC2015[,1]
byCoC2014[,1]

mergers=read.xlsx("PIT_Counts.xlsx",10,stringsAsFactors=FALSE)
mergers=mergers[1:(nrow(mergers)-1),]
head(mergers)

length(unique(mergers[,2])) ## 42

length(intersect(unique(mergers[,1]),unique(mergers[,2]))) ## 4 were created then later merged

length(unique(mergers[,1])) ## 91 were merged, 42 were formed, 4 were remerged

nrow(byCoC2015)-2 ##406





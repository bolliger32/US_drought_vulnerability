#description: Combines Analysis Stage 1 Coefficients into 1 Data Frame
#inputs: beta csv files from code/analysis_stage1/coefficients
#outputs: csv of betas from stage 1 matched to county ID 
#authors: Dan Blaustein Rejto
#start date: 4/18/2016

#get file names
file_list = list.files("code/analysis_stage1/coefficients", full.names=T)

#import csvs as list of dataframes
import.list <- lapply(file_list, read.csv, header = TRUE) 
my.df <- Reduce(function(x, y) merge(x, y, all=FALSE,by=c("countyID"),
                                     all.x=TRUE, all.y=TRUE),import.list,accumulate=F)

#rename columns with unique file name
for (i in 2:length(file_list)) {
  names(my.df)[i] <- substr(toString(file_list[i]),45,50)
}

write.csv(my.df,file="code/analysis_stage2/combined_stage1_betas")
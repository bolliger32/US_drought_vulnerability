#description: Label results graphs for export to report/paper 
#inputs: all stage 2 results csvs from results/stage2...
#outputs: all stage 2 results with human-readable labels in paper/figures
#authors: Dan Blaustein Rejto
#start date: 5/5/2016

##clean environment
rm(list=ls())

##import data

#get file names
file_list = list.files("results/", full.names=F, pattern="*.csv")

#import csvs as list of dataframes
#df.list <- lapply(file_list, read.csv, header = TRUE) 

#define labels
beta_labels = c('65+ Mortality','Unemployment Rate', 'Corn Yield', 'Soybean Yield', 
                'Wheat Yield', '5 & Under Mortality')


#create labeling function
add_labels = function(x){

  #import csv
  filename = paste0("results/",file_list[x])
  dat = read.csv(filename, header=T)
  
  #add labels to outcome values
  dat$Outcome = rep(beta_labels,each = 12)
  
  #remove extraneous columns and rearrange
  dat = dat[,c(2,6,3:5)]
  
  #rename
  colnames(dat)[4] = "Standard_Error"
  colnames(dat)[5] = "P_Value"
  
  #save as new csv file
  new_file_name = paste0("paper/tables/labeled_",file_list[x])
  write.csv(dat,new_file_name)
  
}

#apply labeling function to all csvs in file list
lapply(1:length(file_list),add_labels)
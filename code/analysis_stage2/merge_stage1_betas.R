#description: Merge Analysis Stage 1 Coefficients into 1 Data Frame
#inputs: beta csv files from code/analysis_stage1/coefficients2
#outputs: csv of betas from stage 1 matched to county ID 
#authors: Dan Blaustein Rejto
#start date: 4/18/2016

#get file names
file_list = list.files("code/analysis_stage1/coefficients2", full.names=T, pattern="*.csv")
#file_list=list.files("results/coefficients_stage1/updated",full.names=T, pattern="*.csv")
#import csvs as list of dataframes
import_list <- lapply(file_list, read.csv, header = TRUE) 

#merge
my.df <- Reduce(function(x, y) merge(x, y, all=FALSE,by=c("countyID"),all.x=TRUE, all.y=TRUE),import_list,accumulate=F)

#save
if (dir.exists(paths = "code/analysis_stage2/combined_inputs")==F){
  dir.create("code/analysis_stage2/combined_inputs")
}
#write.csv(my.df,file="code/analysis_stage2/combined_inputs/new/combined_betas.csv")
write.csv(my.df,file="code/analysis_stage2/combined_inputs/combined_betas.csv")
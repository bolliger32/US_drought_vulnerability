#description: Combines Analysis Stage 1 Coefficients and Explanatory Variables into 1 Data Frame
#inputs: -combined beta csv file from code/analysis_stage2/combined_data
#        -ACS data from data/acs
#outputs: csv of betas from stage 1 and explanatory variables matched to county ID 
#authors: Dan Blaustein Rejto
#start date: 4/18/2016

#import combined data and acs data
betas = read.csv("code/analysis_stage2/combined_data/combined_stage1_betas.csv",header=T,stringsAsFactors=F)
acs = read.csv("data/acs/acs.csv",header=T,stringsAsFactors=F)

#reformat acs column ids from county=1001 & state =1 to match betas combined column id of G0100010
#if no zeros on county or state
#colnames(acs)[2] = paste0(0,colnames(acs)[2],0,colnames(acs)[3])

#reformat if 0 in county and then again for 0 in state

#should have 2 csvs of similar size now

#merge them using county id
beta_cty_id = colnames(betas)[2] #sets key to merge files on
acs_cty_id = colnames(betas)[2] #sets key to merge files on
stage2_combined = merge(betas,acs,by.x='beta_cty_id',by.y='acs_cty_id')

#save
write.csv(stage2_combined,file="code/analysis_stage2/combined_data/combined_acs_betas.csv")
## homelessness data download
## DBR
## 2016-03-15

wd="~/Desktop/drought_project/data/homeless" ## replace with your own path name
setwd(wd)

require(xlsx)
require(maptools)
require(downloader)

##download csv of state abbreviations from here
## http://statetable.com without territories, with DC and without military bases or minor possessions

state = read.csv("state_lookup_table.csv",1,stringsAsFactors=FALSE) 

#set working directory
cocs_dir = "~/desktop/drought_project/data/homeless/cocs" #replace with your own path name 
setwd(cocs_dir)

## 2014 CoC shape files:
## Files and metadata available here https://www.hudexchange.info/coc/gis-tools/

##download, extract and read shapefile zip files 
#ST = state acronym

for (row in 1:length(state$abbreviation)) {
  ST = paste(state$abbreviation[row],'_2014','.zip',sep="")
  url = paste("https://www.hudexchange.info/resource/reportmanagement/published/CoC_GIS_State_Shapefile_",ST,sep="") 
  download(url,ST, mode="wb")
  unzip (ST, exdir = state$abbreviation[row])  #used in current version
  #unzip (ST, exdir = "./")  #more efficient to be used in revisions
}

#clean: delete original zip files
unlink("*.zip")